
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>钢材采购切割优化报告</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Microsoft YaHei', '微软雅黑', sans-serif;
      line-height: 1.6;
      color: #333;
      background: #fff;
      padding: 20px;
    }
    
    .header {
      text-align: center;
      border-bottom: 3px solid #1890ff;
      padding-bottom: 20px;
      margin-bottom: 30px;
    }
    
    .header h1 {
      font-size: 28px;
      color: #1890ff;
      margin-bottom: 10px;
    }
    
    .header .meta {
      color: #666;
      font-size: 14px;
    }
    
    .summary-section {
      margin-bottom: 30px;
    }
    
    .summary-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 20px;
    }
    
    .summary-card {
      border: 1px solid #d9d9d9;
      border-radius: 8px;
      padding: 20px;
      text-align: center;
      background: #fafafa;
    }
    
    .summary-card h3 {
      font-size: 14px;
      color: #666;
      margin-bottom: 10px;
    }
    
    .summary-card .value {
      font-size: 24px;
      font-weight: bold;
      color: #1890ff;
    }
    
    .summary-card.success .value {
      color: #52c41a;
    }
    
    .summary-card.warning .value {
      color: #faad14;
    }
    
    .summary-card.error .value {
      color: #ff4d4f;
    }
    
    .status-alert {
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
      font-weight: bold;
    }
    
    .status-alert.success {
      background: #f6ffed;
      border: 1px solid #b7eb8f;
      color: #389e0d;
    }
    
    .status-alert.warning {
      background: #fffbe6;
      border: 1px solid #ffe58f;
      color: #d48806;
    }
    
    .section {
      margin-bottom: 40px;
    }
    
    .section h2 {
      font-size: 20px;
      color: #1890ff;
      border-bottom: 2px solid #1890ff;
      padding-bottom: 10px;
      margin-bottom: 20px;
    }
    
    .cross-section {
      margin-bottom: 30px;
      border: 1px solid #d9d9d9;
      border-radius: 8px;
      padding: 20px;
    }
    
    .cross-section h3 {
      font-size: 18px;
      color: #333;
      margin-bottom: 15px;
      padding: 10px;
      background: #f0f0f0;
      border-radius: 4px;
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
    }
    
    th, td {
      border: 1px solid #d9d9d9;
      padding: 12px;
      text-align: left;
    }
    
    th {
      background: #fafafa;
      font-weight: bold;
      color: #333;
    }
    
    .tag {
      display: inline-block;
      padding: 2px 8px;
      border-radius: 4px;
      font-size: 12px;
      margin: 2px;
    }
    
    .tag.module {
      background: #e6f7ff;
      color: #1890ff;
      border: 1px solid #91d5ff;
    }
    
    .tag.remainder {
      background: #f6ffed;
      color: #52c41a;
      border: 1px solid #b7eb8f;
    }
    
    .tag.cut {
      background: #fff2e8;
      color: #fa8c16;
      border: 1px solid #ffd591;
    }
    
    .tag.waste {
      background: #fff1f0;
      color: #ff4d4f;
      border: 1px solid #ffccc7;
    }
    
    .requirements-table {
      margin-bottom: 20px;
    }
    
    @media print {
      body {
        padding: 10px;
      }
      
      .header {
        break-after: page;
      }
      
      .cross-section {
        break-inside: avoid;
      }
    }
  </style>
</head>
<body>
  <div class="header">
    <h1>钢材采购切割优化报告</h1>
    <div class="meta">
      生成时间: 2025/6/9 19:25:46 | 系统版本: v2.0
    </div>
  </div>

  <div class="summary-section">
    <div class="status-alert warning">
      ⚠ 部分设计需求未满足，请检查切割方案
    </div>
    
    <div class="summary-grid">
      <div class="summary-card success">
        <h3>总损耗率</h3>
        <div class="value">2.50%</div>
      </div>
      
      <div class="summary-card">
        <h3>模数钢材使用量</h3>
        <div class="value">8</div>
      </div>
      
      <div class="summary-card warning">
        <h3>总废料长度</h3>
        <div class="value">800mm</div>
      </div>
      
      <div class="summary-card">
        <h3>计算时间</h3>
        <div class="value">150ms</div>
      </div>
    </div>
  </div>

  <div class="section">
    <h2>需求满足情况</h2>
    <table class="requirements-table">
      <thead>
        <tr>
          <th>设计钢材ID</th>
          <th>长度 (mm)</th>
          <th>需求数量</th>
          <th>生产数量</th>
          <th>满足状态</th>
          <th>差异</th>
        </tr>
      </thead>
      <tbody>
        
          <tr>
            <td>A1</td>
            <td>2,500</td>
            <td>4</td>
            <td>2</td>
            <td>
              <span class="tag waste">
                未满足
              </span>
            </td>
            <td>-2</td>
          </tr>
        
          <tr>
            <td>A2</td>
            <td>4,000</td>
            <td>4</td>
            <td>2</td>
            <td>
              <span class="tag waste">
                未满足
              </span>
            </td>
            <td>-2</td>
          </tr>
        
          <tr>
            <td>B1</td>
            <td>3,000</td>
            <td>6</td>
            <td>2</td>
            <td>
              <span class="tag waste">
                未满足
              </span>
            </td>
            <td>-4</td>
          </tr>
        
      </tbody>
    </table>
  </div>

  <div class="section">
    <h2>模数钢材使用统计</h2>
    <table class="requirements-table">
      <thead>
        <tr>
          <th>模数钢材规格</th>
          <th>截面面积 (mm²)</th>
          <th>长度 (mm)</th>
          <th>使用数量 (根)</th>
          <th>总长度 (mm)</th>
          <th>备注</th>
        </tr>
      </thead>
      <tbody>
        
          <tr>
            <td>
              <span class="tag module">Q235-6000</span>
            </td>
            <td>1,000</td>
            <td>6,000</td>
            <td><strong>1</strong></td>
            <td><strong>6,000</strong></td>
            <td>单根长度6,000mm</td>
          </tr>
        
          <tr>
            <td>
              <span class="tag module">Q235-9000</span>
            </td>
            <td>1,000</td>
            <td>9,000</td>
            <td><strong>1</strong></td>
            <td><strong>9,000</strong></td>
            <td>单根长度9,000mm</td>
          </tr>
        
          <tr>
            <td>
              <span class="tag module">Q235-6000</span>
            </td>
            <td>1,500</td>
            <td>6,000</td>
            <td><strong>1</strong></td>
            <td><strong>6,000</strong></td>
            <td>单根长度6,000mm</td>
          </tr>
        
        
          <tr style="background-color: #f5f5f5; font-weight: bold;">
            <td>截面1000小计</td>
            <td>1000</td>
            <td>-</td>
            <td style="color: #1890ff;">2</td>
            <td style="color: #1890ff;">15,000</td>
            <td>截面1000mm²合计</td>
          </tr>
        
          <tr style="background-color: #f5f5f5; font-weight: bold;">
            <td>截面1500小计</td>
            <td>1500</td>
            <td>-</td>
            <td style="color: #1890ff;">1</td>
            <td style="color: #1890ff;">6,000</td>
            <td>截面1500mm²合计</td>
          </tr>
        
        <tr style="background-color: #e6f7ff; font-weight: bold; font-size: 16px;">
          <td><strong>总计</strong></td>
          <td>-</td>
          <td>-</td>
          <td style="color: #1890ff;"><strong>3</strong></td>
          <td style="color: #1890ff;"><strong>21,000</strong></td>
          <td><strong>所有模数钢材总计</strong></td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="section">
    <h2>各截面详细切割方案</h2>
    
    
        <div class="cross-section">
          <h3>截面 1000 (损耗率: 3.33%)</h3>
          
          <table>
            <thead>
              <tr>
                <th>原料信息</th>
                <th>原料长度 (mm)</th>
                <th>切割详情</th>
                <th>新余料</th>
                <th>废料 (mm)</th>
              </tr>
            </thead>
            <tbody>
              
                <tr>
                  <td>
                    <span class="tag module">
                      Q235-6000
                    </span>
                  </td>
                  <td>6,000</td>
                  <td>
                    <span class="tag cut">A1: 2,500mm × 2件</span>
                  </td>
                  <td>
                    <span class="tag remainder">a1: 1,000mm</span>
                  </td>
                  <td>
                    <span class="tag waste">0</span>
                  </td>
                </tr>
              
                <tr>
                  <td>
                    <span class="tag module">
                      Q235-9000
                    </span>
                  </td>
                  <td>9,000</td>
                  <td>
                    <span class="tag cut">A2: 4,000mm × 2件</span>
                  </td>
                  <td>
                    <span class="tag remainder">a2: 1,000mm</span>
                  </td>
                  <td>
                    <span class="tag waste">0</span>
                  </td>
                </tr>
              
            </tbody>
          </table>
        </div>
      
        <div class="cross-section">
          <h3>截面 1500 (损耗率: 5.00%)</h3>
          
          <table>
            <thead>
              <tr>
                <th>原料信息</th>
                <th>原料长度 (mm)</th>
                <th>切割详情</th>
                <th>新余料</th>
                <th>废料 (mm)</th>
              </tr>
            </thead>
            <tbody>
              
                <tr>
                  <td>
                    <span class="tag module">
                      Q235-6000
                    </span>
                  </td>
                  <td>6,000</td>
                  <td>
                    <span class="tag cut">B1: 3,000mm × 2件</span>
                  </td>
                  <td>
                    
                  </td>
                  <td>
                    <span class="tag waste">0</span>
                  </td>
                </tr>
              
            </tbody>
          </table>
        </div>
      
  </div>

  <div class="section">
    <h2>报告说明</h2>
    <ul>
      <li><strong>损耗率计算</strong>: 废料长度 ÷ 总材料长度 × 100%</li>
      <li><strong>优化目标</strong>: 在满足所有设计需求的前提下，最小化材料损耗</li>
      <li><strong>余料管理</strong>: 系统自动管理余料库存，优先使用长余料</li>
      <li><strong>材料规格</strong>: 基于设定的模数钢材规格进行优化</li>
      <li><strong>建议</strong>: 损耗率低于3%为优秀，3-8%为良好，超过8%建议重新优化</li>
    </ul>
  </div>

</body>
</html>
  